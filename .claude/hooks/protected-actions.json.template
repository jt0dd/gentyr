{
  "version": "2.0.0",
  "description": "CTO-protected MCP actions configuration. Protected actions require CTO or deputy-CTO approval before execution. Unknown MCP servers are blocked by default (Fix 3: server allowlist).",
  "servers": {},
  "allowedUnprotectedServers": [],
  "settings": {
    "codeLength": 6,
    "expiryMinutes": 5,
    "notifyOnBlock": true
  },
  "_examples": {
    "supabase-prod": {
      "protection": "credential-isolated",
      "phrase": "APPROVE PROD",
      "tools": "*",
      "credentialKeys": ["SUPABASE_SERVICE_ROLE_KEY"],
      "description": "Production Supabase - all tools require CTO approval"
    },
    "vercel": {
      "protection": "deputy-cto-approval",
      "phrase": "APPROVE DEPLOY",
      "tools": ["vercel_promote_deployment", "vercel_rollback", "vercel_create_env_var", "vercel_delete_env_var"],
      "credentialKeys": ["VERCEL_TOKEN"],
      "description": "Deployment ops - deputy-cto can approve non-production, CTO required for production"
    },
    "stripe": {
      "protection": "credential-isolated",
      "phrase": "APPROVE PAYMENT",
      "tools": ["create_charge", "create_refund", "delete_customer"],
      "credentialKeys": ["STRIPE_SECRET_KEY"],
      "description": "Stripe - only destructive/financial tools require CTO approval"
    },
    "sendgrid": {
      "protection": "approval-only",
      "phrase": "APPROVE EMAIL",
      "tools": ["send_email", "send_bulk"],
      "description": "SendGrid - CTO approval required but credentials not isolated"
    }
  },
  "_allowedUnprotectedServers_note": "Framework/internal MCP servers that don't need protection. Any server NOT in 'servers' and NOT in this list will be BLOCKED.",
  "_schema": {
    "servers": {
      "<server-name>": {
        "protection": "credential-isolated | approval-only | deputy-cto-approval",
        "phrase": "APPROVE <WORD>",
        "tools": "* | [list of tool names]",
        "credentialKeys": ["ENV_VAR_NAMES_TO_ENCRYPT"],
        "description": "Human-readable description"
      }
    },
    "allowedUnprotectedServers": ["List of MCP server names that are allowed without protection (e.g., framework servers like agent-tracker, todo-db)"],
    "settings": {
      "codeLength": "Number of characters in approval code (default: 6)",
      "expiryMinutes": "How long approval codes are valid (default: 5)",
      "notifyOnBlock": "Show notification when action is blocked (default: true)"
    },
    "_protection_modes": {
      "credential-isolated": "CTO approval required. Credentials stored in .mcp.json, not in shell env.",
      "approval-only": "CTO approval required. No credential isolation.",
      "deputy-cto-approval": "Deputy-CTO AI agent can approve, deny, or escalate to CTO. Less secure but lower friction."
    }
  }
}
